"use strict";var WORLD_SIDE_SIZE=7,WINDOW_HEIGHT=window.innerHeight,WINDOW_WIDTH=window.innerWidth,ROAD_COLORS=[16711680,16746496,16776960,65280,65535,255,16711935],NUMBER_COLORS=ROAD_COLORS.length,WORLD_HEIGHT=1e3,WORLD_WIDTH=100,CAR_SIZE_X=10,CAR_SIZE_Y=10,CAR_SIZE_Z=10,Player=function(){function e(e){e=e||event,E[e.which]="keydown"===e.type}var t=new THREE.PerspectiveCamera(75,WINDOW_WIDTH/WINDOW_HEIGHT,.1,1e3),n=function(){var e=(new THREE.TextureLoader).load("/assets/object-textures/player.jpg"),n=new THREE.BoxGeometry(CAR_SIZE_X,CAR_SIZE_Y,CAR_SIZE_Z),r=new THREE.MeshBasicMaterial({map:e}),o=new THREE.Mesh(n,r);return o.position.y=n.parameters.height/2,o.add(t),o}(),r={movement:{arrows:{up:38,down:40,left:37,right:39},wasd:{up:87,down:83,left:65,right:68}},reset:8},o=r.movement.arrows,a=.5,i=.03,E={};return document.addEventListener("keydown",e,!1),document.addEventListener("keyup",e,!1),{doMovementLoop:function(){E[o.up]&&n.translateZ(-a),E[o.left]&&n.rotateY(i),E[o.right]&&n.rotateY(-i),E[o.down]&&n.translateZ(a),E[r.reset]&&(n.rotation.y=0,n.position.set(0,n.position.y,0))},playerObject:n,camera:t}}(),NotMarioKart=function(){function e(){for(var e=new THREE.PlaneGeometry(WORLD_WIDTH,WORLD_HEIGHT,WORLD_SIDE_SIZE,1),t=[],r=0;r<NUMBER_COLORS;r++)t.push(new THREE.MeshBasicMaterial({color:ROAD_COLORS[r],side:THREE.DoubleSide}));for(var o=e.faces.length/2,a=0;a<o;a++){var i=2*a;e.faces[i].materialIndex=(a+Math.floor(a/WORLD_SIDE_SIZE))%NUMBER_COLORS,e.faces[i+1].materialIndex=(a+Math.floor(a/WORLD_SIDE_SIZE))%NUMBER_COLORS}var E=new THREE.Mesh(e,t);E.rotateX(-Math.PI/2),E.position.y=0,n.add(E)}function t(){requestAnimationFrame(t),r.clear(),r.setViewport(0,0,WINDOW_WIDTH,WINDOW_HEIGHT),r.render(n,Player.camera),r.setViewport(WINDOW_WIDTH-200,50,150,150),r.render(n,o),Player.doMovementLoop()}var n=new THREE.Scene,r=new THREE.WebGLRenderer,o=new THREE.PerspectiveCamera(75,1,.1,1e3);return{init:function(){r.setSize(WINDOW_WIDTH,WINDOW_HEIGHT),r.setPixelRatio(window.devicePixelRatio),r.domElement.style.position="relative",document.body.appendChild(r.domElement),r.autoClear=!1,o.position.y=500,o.rotation.x=-90*Math.PI/180,e(),n.add(Player.playerObject),t()}}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnN0YW50cy5qcyIsIlBsYXllci5qcyIsIk5vdE1hcmlvS2FydC5qcyJdLCJuYW1lcyI6WyJXT1JMRF9TSURFX1NJWkUiLCJXSU5ET1dfSEVJR0hUIiwid2luZG93IiwiaW5uZXJIZWlnaHQiLCJXSU5ET1dfV0lEVEgiLCJpbm5lcldpZHRoIiwiUk9BRF9DT0xPUlMiLCJOVU1CRVJfQ09MT1JTIiwibGVuZ3RoIiwiV09STERfSEVJR0hUIiwiV09STERfV0lEVEgiLCJDQVJfU0laRV9YIiwiQ0FSX1NJWkVfWSIsIkNBUl9TSVpFX1oiLCJQbGF5ZXIiLCJvbktleU1vdmUiLCJlIiwiZXZlbnQiLCJrZXlDb2RlTWFwIiwid2hpY2giLCJ0eXBlIiwiY2FtZXJhIiwiVEhSRUUiLCJQZXJzcGVjdGl2ZUNhbWVyYSIsInBsYXllck9iamVjdCIsInRleHR1cmUiLCJUZXh0dXJlTG9hZGVyIiwibG9hZCIsImdlb21ldHJ5IiwiQm94R2VvbWV0cnkiLCJtYXRlcmlhbCIsIk1lc2hCYXNpY01hdGVyaWFsIiwibWFwIiwib2JqZWN0IiwiTWVzaCIsInBvc2l0aW9uIiwieSIsInBhcmFtZXRlcnMiLCJoZWlnaHQiLCJhZGQiLCJtYWtlUGxheWVyT2JqZWN0IiwiY29udHJvbHMiLCJtb3ZlbWVudCIsImFycm93cyIsInVwIiwiZG93biIsImxlZnQiLCJyaWdodCIsIndhc2QiLCJyZXNldCIsImVuYWJsZWRDb250cm9scyIsInNwZWVkIiwicm90YXRpb25TcGVlZCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImRvTW92ZW1lbnRMb29wIiwidHJhbnNsYXRlWiIsInJvdGF0ZVkiLCJyb3RhdGlvbiIsInNldCIsIk5vdE1hcmlvS2FydCIsImJ1aWxkRmxvb3IiLCJQbGFuZUdlb21ldHJ5IiwibWF0ZXJpYWxzIiwiaSIsInB1c2giLCJjb2xvciIsInNpZGUiLCJEb3VibGVTaWRlIiwiZ2VvRmFjZXNMZW5ndGgiLCJmYWNlcyIsImoiLCJtYXRlcmlhbEluZGV4IiwiTWF0aCIsImZsb29yIiwicm90YXRlWCIsIlBJIiwic2NlbmUiLCJsb29wIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwicmVuZGVyZXIiLCJjbGVhciIsInNldFZpZXdwb3J0IiwicmVuZGVyIiwibWluaU1hcENhbWVyYSIsIlNjZW5lIiwiV2ViR0xSZW5kZXJlciIsImluaXQiLCJzZXRTaXplIiwic2V0UGl4ZWxSYXRpbyIsImRldmljZVBpeGVsUmF0aW8iLCJkb21FbGVtZW50Iiwic3R5bGUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJhdXRvQ2xlYXIiLCJ4Il0sIm1hcHBpbmdzIjoiYUFJQSxJQUFNQSxnQkFBa0IsRUFDbEJDLGNBQWdCQyxPQUFPQyxZQUN2QkMsYUFBZUYsT0FBT0csV0FDdEJDLGFBQ0YsU0FDQSxTQUNBLFNBQ0EsTUFDQSxNQUNBLElBQ0EsVUFFRUMsY0FBZ0JELFlBQVlFLE9BQzVCQyxhQUFlLElBQ2ZDLFlBQWMsSUFDZEMsV0FBYSxHQUNiQyxXQUFhLEdBQ2JDLFdBQWEsR0NqQmJDLE9BQVUsV0FvQ1osU0FBU0MsRUFBVUMsR0FDZkEsRUFBSUEsR0FBS0MsTUFDVEMsRUFBV0YsRUFBRUcsT0FBb0IsWUFBWEgsRUFBRUksS0FyQzVCLElBQU1DLEVBQVMsSUFBSUMsTUFBTUMsa0JBQ3JCLEdBQ0FuQixhQUFlSCxjQUNmLEdBQ0EsS0FHRXVCLEVBdUROLFdBQ0ksSUFBTUMsR0FBVSxJQUFJSCxNQUFNSSxlQUFnQkMsS0FBSyxzQ0FDekNDLEVBQVcsSUFBSU4sTUFBTU8sWUFDdkJsQixXQUNBQyxXQUNBQyxZQUVFaUIsRUFBVyxJQUFJUixNQUFNUyxtQkFBb0JDLElBQUtQLElBQzlDUSxFQUFTLElBQUlYLE1BQU1ZLEtBQUtOLEVBQVVFLEdBTXhDLE9BSkFHLEVBQU9FLFNBQVNDLEVBQUlSLEVBQVNTLFdBQVdDLE9BQVMsRUFFakRMLEVBQU9NLElBQUlsQixHQUVKWSxFQXJFVU8sR0FFZkMsR0FDRkMsVUFFSUMsUUFDSUMsR0FBSSxHQUNKQyxLQUFNLEdBQ05DLEtBQU0sR0FDTkMsTUFBTyxJQUVYQyxNQUNJSixHQUFJLEdBQ0pDLEtBQU0sR0FDTkMsS0FBTSxHQUNOQyxNQUFPLEtBR2ZFLE1BQU8sR0FHUEMsRUFBa0JULEVBQVNDLFNBQVNDLE9BRWxDUSxFQUFRLEdBQ1JDLEVBQWdCLElBRWhCbEMsS0E4Q04sT0F2Q0FtQyxTQUFTQyxpQkFBaUIsVUFBV3ZDLEdBQVcsR0FDaERzQyxTQUFTQyxpQkFBaUIsUUFBU3ZDLEdBQVcsSUF1QzFDd0MsZUFyQ0osV0FDUXJDLEVBQVdnQyxFQUFnQk4sS0FDM0JwQixFQUFhZ0MsWUFBWUwsR0FFekJqQyxFQUFXZ0MsRUFBZ0JKLE9BQzNCdEIsRUFBYWlDLFFBQVFMLEdBRXJCbEMsRUFBV2dDLEVBQWdCSCxRQUMzQnZCLEVBQWFpQyxTQUFTTCxHQUV0QmxDLEVBQVdnQyxFQUFnQkwsT0FDM0JyQixFQUFhZ0MsV0FBV0wsR0FFeEJqQyxFQUFXdUIsRUFBU1EsU0FDcEJ6QixFQUFha0MsU0FBU3RCLEVBQUksRUFDMUJaLEVBQWFXLFNBQVN3QixJQUFJLEVBQUduQyxFQUFhVyxTQUFTQyxFQUFHLEtBdUIxRFosYUFBY0EsRUFDZEgsT0FBUUEsR0FuRkEsR0NBVnVDLGFBQWdCLFdBS2xCLFNBQVNDLElBUUwsSUFBSyxJQVBDakMsRUFBVyxJQUFJTixNQUFNd0MsY0FDdkJwRCxZQUNBRCxhQUNBVCxnQkFDQSxHQUVBK0QsS0FDS0MsRUFBSSxFQUFHQSxFQUFJekQsY0FBZXlELElBQy9CRCxFQUFVRSxLQUNOLElBQUkzQyxNQUFNUyxtQkFDTm1DLE1BQU81RCxZQUFZMEQsR0FDbkJHLEtBQU03QyxNQUFNOEMsY0FLeEIsSUFBSyxJQURDQyxFQUFpQnpDLEVBQVMwQyxNQUFNOUQsT0FBUyxFQUN0Q3dELEVBQUksRUFBR0EsRUFBSUssRUFBZ0JMLElBQUssQ0FDckMsSUFBSU8sRUFBUSxFQUFKUCxFQUVScEMsRUFBUzBDLE1BQU1DLEdBQUdDLGVBQ2JSLEVBQUlTLEtBQUtDLE1BQU1WLEVBQUloRSxrQkFBb0JPLGNBRTVDcUIsRUFBUzBDLE1BQU1DLEVBQUksR0FBR0MsZUFDakJSLEVBQUlTLEtBQUtDLE1BQU1WLEVBQUloRSxrQkFBb0JPLGNBR2hELElBQUltRSxFQUFRLElBQUlwRCxNQUFNWSxLQUFLTixFQUFVbUMsR0FDckNXLEVBQU1DLFNBQVNGLEtBQUtHLEdBQUssR0FDekJGLEVBQU12QyxTQUFTQyxFQUFJLEVBRW5CeUMsRUFBTXRDLElBQUltQyxHQW9CZCxTQUFTSSxJQUNMQyxzQkFBc0JELEdBRXRCRSxFQUFTQyxRQUVURCxFQUFTRSxZQUFZLEVBQUcsRUFBRzlFLGFBQWNILGVBQ3pDK0UsRUFBU0csT0FBT04sRUFBTy9ELE9BQU9PLFFBRTlCMkQsRUFBU0UsWUFBWTlFLGFBQWUsSUFBSyxHQUFJLElBQUssS0FDbEQ0RSxFQUFTRyxPQUFPTixFQUFPTyxHQUV2QnRFLE9BQU95QyxpQkFsRVgsSUFBTXNCLEVBQVEsSUFBSXZELE1BQU0rRCxNQUNsQkwsRUFBVyxJQUFJMUQsTUFBTWdFLGNBQ3JCRixFQUFnQixJQUFJOUQsTUFBTUMsa0JBQWtCLEdBQUksRUFBRyxHQUFLLEtBbUU5RCxPQUNJZ0UsS0FoQ0osV0FDSVAsRUFBU1EsUUFBUXBGLGFBQWNILGVBQy9CK0UsRUFBU1MsY0FBY3ZGLE9BQU93RixrQkFDOUJWLEVBQVNXLFdBQVdDLE1BQU16RCxTQUFXLFdBQ3JDa0IsU0FBU3dDLEtBQUtDLFlBQVlkLEVBQVNXLFlBQ25DWCxFQUFTZSxXQUFZLEVBRXJCWCxFQUFjakQsU0FBU0MsRUFBSSxJQUMzQmdELEVBQWMxQixTQUFTc0MsR0FBSyxHQUFLdkIsS0FBS0csR0FBSyxJQUUzQ2YsSUFFQWdCLEVBQU10QyxJQUFJekIsT0FBT1UsY0FFakJzRCxNQXJEYyIsImZpbGUiOiJidW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBbGwgY29uc3RhbnRzLCBhdmFpbGFibGUgaW4gZ2xvYmFsIHdpbmRvdy5cbiAqL1xuXG5jb25zdCBXT1JMRF9TSURFX1NJWkUgPSA3O1xuY29uc3QgV0lORE9XX0hFSUdIVCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbmNvbnN0IFdJTkRPV19XSURUSCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuY29uc3QgUk9BRF9DT0xPUlMgPSBbXG4gICAgMHhmZjAwMDAsXG4gICAgMHhmZjg4MDAsXG4gICAgMHhmZmZmMDAsXG4gICAgMHgwMGZmMDAsXG4gICAgMHgwMGZmZmYsXG4gICAgMHgwMDAwZmYsXG4gICAgMHhmZjAwZmZcbl07XG5jb25zdCBOVU1CRVJfQ09MT1JTID0gUk9BRF9DT0xPUlMubGVuZ3RoO1xuY29uc3QgV09STERfSEVJR0hUID0gMTAwMDtcbmNvbnN0IFdPUkxEX1dJRFRIID0gMTAwO1xuY29uc3QgQ0FSX1NJWkVfWCA9IDEwO1xuY29uc3QgQ0FSX1NJWkVfWSA9IDEwO1xuY29uc3QgQ0FSX1NJWkVfWiA9IDEwO1xuIiwiLyoqXG4gKiBFdmVyeXRoaW5nIGFib3V0IHRoZSBQbGF5ZXIgb2JqZWN0LCBpdHMgY2FtZXJhLCB0aGUgbW92ZW1lbnRzIC4uLlxuICovXG5cbmNvbnN0IFBsYXllciA9IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKFxuICAgICAgICA3NSxcbiAgICAgICAgV0lORE9XX1dJRFRIIC8gV0lORE9XX0hFSUdIVCxcbiAgICAgICAgMC4xLFxuICAgICAgICAxMDAwXG4gICAgKTtcblxuICAgIGNvbnN0IHBsYXllck9iamVjdCA9IG1ha2VQbGF5ZXJPYmplY3QoKTtcblxuICAgIGNvbnN0IGNvbnRyb2xzID0ge1xuICAgICAgICBtb3ZlbWVudDoge1xuICAgICAgICAgICAgLy8gVE9ETzogdGhlc2Ugc2hvdWxkIGJlIGluIGEgc2V0dGluZ3MgbWVudSBvbmNlIHdlIGhhdmUgb25lLlxuICAgICAgICAgICAgYXJyb3dzOiB7XG4gICAgICAgICAgICAgICAgdXA6IDM4LFxuICAgICAgICAgICAgICAgIGRvd246IDQwLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDM3LFxuICAgICAgICAgICAgICAgIHJpZ2h0OiAzOVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHdhc2Q6IHtcbiAgICAgICAgICAgICAgICB1cDogODcsXG4gICAgICAgICAgICAgICAgZG93bjogODMsXG4gICAgICAgICAgICAgICAgbGVmdDogNjUsXG4gICAgICAgICAgICAgICAgcmlnaHQ6IDY4XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc2V0OiA4XG4gICAgfTtcblxuICAgIGxldCBlbmFibGVkQ29udHJvbHMgPSBjb250cm9scy5tb3ZlbWVudC5hcnJvd3M7XG5cbiAgICBjb25zdCBzcGVlZCA9IDAuNTtcbiAgICBjb25zdCByb3RhdGlvblNwZWVkID0gMC4wMztcblxuICAgIGNvbnN0IGtleUNvZGVNYXAgPSB7fTtcblxuICAgIGZ1bmN0aW9uIG9uS2V5TW92ZShlKSB7XG4gICAgICAgIGUgPSBlIHx8IGV2ZW50OyAvLyBGb3IgSUUuXG4gICAgICAgIGtleUNvZGVNYXBbZS53aGljaF0gPSBlLnR5cGUgPT09ICdrZXlkb3duJztcbiAgICB9XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25LZXlNb3ZlLCBmYWxzZSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBvbktleU1vdmUsIGZhbHNlKTtcblxuICAgIGZ1bmN0aW9uIGRvTW92ZW1lbnRMb29wKCkge1xuICAgICAgICBpZiAoa2V5Q29kZU1hcFtlbmFibGVkQ29udHJvbHMudXBdKSB7XG4gICAgICAgICAgICBwbGF5ZXJPYmplY3QudHJhbnNsYXRlWigtc3BlZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChrZXlDb2RlTWFwW2VuYWJsZWRDb250cm9scy5sZWZ0XSkge1xuICAgICAgICAgICAgcGxheWVyT2JqZWN0LnJvdGF0ZVkocm90YXRpb25TcGVlZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGtleUNvZGVNYXBbZW5hYmxlZENvbnRyb2xzLnJpZ2h0XSkge1xuICAgICAgICAgICAgcGxheWVyT2JqZWN0LnJvdGF0ZVkoLXJvdGF0aW9uU3BlZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChrZXlDb2RlTWFwW2VuYWJsZWRDb250cm9scy5kb3duXSkge1xuICAgICAgICAgICAgcGxheWVyT2JqZWN0LnRyYW5zbGF0ZVooc3BlZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChrZXlDb2RlTWFwW2NvbnRyb2xzLnJlc2V0XSkge1xuICAgICAgICAgICAgcGxheWVyT2JqZWN0LnJvdGF0aW9uLnkgPSAwO1xuICAgICAgICAgICAgcGxheWVyT2JqZWN0LnBvc2l0aW9uLnNldCgwLCBwbGF5ZXJPYmplY3QucG9zaXRpb24ueSwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYWtlUGxheWVyT2JqZWN0KCkge1xuICAgICAgICBjb25zdCB0ZXh0dXJlID0gbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKCcvYXNzZXRzL29iamVjdC10ZXh0dXJlcy9wbGF5ZXIuanBnJyk7XG4gICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KFxuICAgICAgICAgICAgQ0FSX1NJWkVfWCxcbiAgICAgICAgICAgIENBUl9TSVpFX1ksXG4gICAgICAgICAgICBDQVJfU0laRV9aXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHsgbWFwOiB0ZXh0dXJlIH0pO1xuICAgICAgICBjb25zdCBvYmplY3QgPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xuXG4gICAgICAgIG9iamVjdC5wb3NpdGlvbi55ID0gZ2VvbWV0cnkucGFyYW1ldGVycy5oZWlnaHQgLyAyO1xuXG4gICAgICAgIG9iamVjdC5hZGQoY2FtZXJhKTtcblxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGRvTW92ZW1lbnRMb29wOiBkb01vdmVtZW50TG9vcCxcbiAgICAgICAgcGxheWVyT2JqZWN0OiBwbGF5ZXJPYmplY3QsXG4gICAgICAgIGNhbWVyYTogY2FtZXJhXG4gICAgfTtcbn0pKCk7XG4iLCIvKipcbiAqIE1haW4gZmlsZSBvZiB0aGUgZ2FtZS5cbiAqL1xuXG5jb25zdCBOb3RNYXJpb0thcnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG4gICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcigpO1xuICAgIGNvbnN0IG1pbmlNYXBDYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoNzUsIDEsIDAuMSwgMTAwMCk7XG5cbiAgICBmdW5jdGlvbiBidWlsZEZsb29yKCkge1xuICAgICAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KFxuICAgICAgICAgICAgV09STERfV0lEVEgsXG4gICAgICAgICAgICBXT1JMRF9IRUlHSFQsXG4gICAgICAgICAgICBXT1JMRF9TSURFX1NJWkUsXG4gICAgICAgICAgICAxXG4gICAgICAgICk7XG4gICAgICAgIGxldCBtYXRlcmlhbHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBOVU1CRVJfQ09MT1JTOyBpKyspIHtcbiAgICAgICAgICAgIG1hdGVyaWFscy5wdXNoKFxuICAgICAgICAgICAgICAgIG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBST0FEX0NPTE9SU1tpXSxcbiAgICAgICAgICAgICAgICAgICAgc2lkZTogVEhSRUUuRG91YmxlU2lkZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGdlb0ZhY2VzTGVuZ3RoID0gZ2VvbWV0cnkuZmFjZXMubGVuZ3RoIC8gMjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnZW9GYWNlc0xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgaiA9IGkgKiAyOyAvLyA8LS0gQWRkZWQgdGhpcyBiYWNrIHNvIHdlIGNhbiBkbyBldmVyeSBvdGhlciAnZmFjZSdcblxuICAgICAgICAgICAgZ2VvbWV0cnkuZmFjZXNbal0ubWF0ZXJpYWxJbmRleCA9XG4gICAgICAgICAgICAgICAgKGkgKyBNYXRoLmZsb29yKGkgLyBXT1JMRF9TSURFX1NJWkUpKSAlIE5VTUJFUl9DT0xPUlM7XG5cbiAgICAgICAgICAgIGdlb21ldHJ5LmZhY2VzW2ogKyAxXS5tYXRlcmlhbEluZGV4ID1cbiAgICAgICAgICAgICAgICAoaSArIE1hdGguZmxvb3IoaSAvIFdPUkxEX1NJREVfU0laRSkpICUgTlVNQkVSX0NPTE9SUzsgLy8gT3RoZXIgaGFsZiBvZiB0aGUgc2FtZSBmYWNlXG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZmxvb3IgPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWxzKTtcbiAgICAgICAgZmxvb3Iucm90YXRlWCgtTWF0aC5QSSAvIDIpO1xuICAgICAgICBmbG9vci5wb3NpdGlvbi55ID0gMDtcblxuICAgICAgICBzY2VuZS5hZGQoZmxvb3IpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIHJlbmRlcmVyLnNldFNpemUoV0lORE9XX1dJRFRILCBXSU5ET1dfSEVJR0hUKTtcbiAgICAgICAgcmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7XG4gICAgICAgIHJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHJlbmRlcmVyLmRvbUVsZW1lbnQpO1xuICAgICAgICByZW5kZXJlci5hdXRvQ2xlYXIgPSBmYWxzZTtcblxuICAgICAgICBtaW5pTWFwQ2FtZXJhLnBvc2l0aW9uLnkgPSA1MDA7XG4gICAgICAgIG1pbmlNYXBDYW1lcmEucm90YXRpb24ueCA9IC05MCAqIE1hdGguUEkgLyAxODA7XG5cbiAgICAgICAgYnVpbGRGbG9vcigpO1xuXG4gICAgICAgIHNjZW5lLmFkZChQbGF5ZXIucGxheWVyT2JqZWN0KTtcblxuICAgICAgICBsb29wKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9vcCgpIHtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xuXG4gICAgICAgIHJlbmRlcmVyLmNsZWFyKCk7XG5cbiAgICAgICAgcmVuZGVyZXIuc2V0Vmlld3BvcnQoMCwgMCwgV0lORE9XX1dJRFRILCBXSU5ET1dfSEVJR0hUKTtcbiAgICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBQbGF5ZXIuY2FtZXJhKTtcblxuICAgICAgICByZW5kZXJlci5zZXRWaWV3cG9ydChXSU5ET1dfV0lEVEggLSAyMDAsIDUwLCAxNTAsIDE1MCk7XG4gICAgICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgbWluaU1hcENhbWVyYSk7XG5cbiAgICAgICAgUGxheWVyLmRvTW92ZW1lbnRMb29wKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5pdDogaW5pdFxuICAgIH07XG59KSgpO1xuIl19
