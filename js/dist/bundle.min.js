"use strict";var WORLD_SIDE_SIZE=7,WINDOW_HEIGHT=window.innerHeight,WINDOW_WIDTH=window.innerWidth,ROAD_COLORS=[16711680,16746496,16776960,65280,65535,255,16711935],NUMBER_COLORS=ROAD_COLORS.length,WORLD_HEIGHT=1e3,WORLD_WIDTH=100,CAR_SIZE_X=10,CAR_SIZE_Y=10,CAR_SIZE_Z=10,NotMarioKart=function(){function e(){for(var e=new THREE.PlaneGeometry(WORLD_WIDTH,WORLD_HEIGHT,WORLD_SIDE_SIZE,1),t=[],n=0;n<ROAD_COLORS.length;n++)t.push(new THREE.MeshBasicMaterial({color:ROAD_COLORS[n],side:THREE.DoubleSide}));for(var r=e.faces.length/2,a=0;a<r;a++){var i=2*a;e.faces[i].materialIndex=(a+Math.floor(a/WORLD_SIDE_SIZE))%NUMBER_COLORS,e.faces[i+1].materialIndex=(a+Math.floor(a/WORLD_SIDE_SIZE))%NUMBER_COLORS}var E=new THREE.Mesh(e,t);E.rotateX(-Math.PI/2),E.position.y=0,o.add(E)}function t(){requestAnimationFrame(t),n.clear(),n.setViewport(0,0,WINDOW_WIDTH,WINDOW_HEIGHT),n.render(o,Player.camera),n.setViewport(WINDOW_WIDTH-200,50,150,150),n.render(o,r),Player.doMovementLoop()}var o=new THREE.Scene,n=new THREE.WebGLRenderer,r=new THREE.PerspectiveCamera(75,1,.1,1e3);return{init:function(){n.setSize(WINDOW_WIDTH,WINDOW_HEIGHT),n.setPixelRatio(window.devicePixelRatio),n.domElement.style.position="relative",document.body.appendChild(n.domElement),n.autoClear=!1,r.position.y=500,r.rotation.x=-90*Math.PI/180,e(),t()},addToScene:function(e){o.add(e)}}}(),Player=function(){function e(e){e=e||event,E[e.which]="keydown"===e.type}var t=new THREE.PerspectiveCamera(75,WINDOW_WIDTH/WINDOW_HEIGHT,.1,1e3),o=function(){var e=(new THREE.TextureLoader).load("/assets/object-textures/player.jpg"),o=new THREE.BoxGeometry(CAR_SIZE_X,CAR_SIZE_Y,CAR_SIZE_Z),n=new THREE.MeshBasicMaterial({map:e}),r=new THREE.Mesh(o,n);return r.position.y=r.geometry.parameters.height/2,t.position.x=1,t.position.y=10,t.position.z=15,r.add(t),NotMarioKart.addToScene(r),r}(),n={movement:{arrows:{up:38,down:40,left:37,right:39},wasd:{up:87,down:83,left:65,right:68}},reset:8},r=n.movement.arrows,a=.5,i=.03,E={};return document.addEventListener("keydown",e,!1),document.addEventListener("keyup",e,!1),{doMovementLoop:function(){E[r.up]&&o.translateZ(-a),E[r.left]&&o.rotateY(i),E[r.right]&&o.rotateY(-i),E[r.down]&&o.translateZ(a),E[n.reset]&&(o.rotation.y=0,o.position.set(0,o.position.y,0))},playerObject:o,camera:t}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnN0YW50cy5qcyIsIk5vdE1hcmlvS2FydC5qcyIsIlBsYXllci5qcyJdLCJuYW1lcyI6WyJXT1JMRF9TSURFX1NJWkUiLCJXSU5ET1dfSEVJR0hUIiwid2luZG93IiwiaW5uZXJIZWlnaHQiLCJXSU5ET1dfV0lEVEgiLCJpbm5lcldpZHRoIiwiUk9BRF9DT0xPUlMiLCJOVU1CRVJfQ09MT1JTIiwibGVuZ3RoIiwiV09STERfSEVJR0hUIiwiV09STERfV0lEVEgiLCJDQVJfU0laRV9YIiwiQ0FSX1NJWkVfWSIsIkNBUl9TSVpFX1oiLCJOb3RNYXJpb0thcnQiLCJidWlsZEZsb29yIiwiZ2VvbWV0cnkiLCJUSFJFRSIsIlBsYW5lR2VvbWV0cnkiLCJtYXRlcmlhbHMiLCJpIiwicHVzaCIsIk1lc2hCYXNpY01hdGVyaWFsIiwiY29sb3IiLCJzaWRlIiwiRG91YmxlU2lkZSIsImdlb0ZhY2VzTGVuZ3RoIiwiZmFjZXMiLCJqIiwibWF0ZXJpYWxJbmRleCIsIk1hdGgiLCJmbG9vciIsIk1lc2giLCJyb3RhdGVYIiwiUEkiLCJwb3NpdGlvbiIsInkiLCJzY2VuZSIsImFkZCIsImxvb3AiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJyZW5kZXJlciIsImNsZWFyIiwic2V0Vmlld3BvcnQiLCJyZW5kZXIiLCJQbGF5ZXIiLCJjYW1lcmEiLCJtaW5pTWFwQ2FtZXJhIiwiZG9Nb3ZlbWVudExvb3AiLCJTY2VuZSIsIldlYkdMUmVuZGVyZXIiLCJQZXJzcGVjdGl2ZUNhbWVyYSIsImluaXQiLCJzZXRTaXplIiwic2V0UGl4ZWxSYXRpbyIsImRldmljZVBpeGVsUmF0aW8iLCJkb21FbGVtZW50Iiwic3R5bGUiLCJkb2N1bWVudCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImF1dG9DbGVhciIsInJvdGF0aW9uIiwieCIsImFkZFRvU2NlbmUiLCJvYmplY3QiLCJvbktleU1vdmUiLCJlIiwiZXZlbnQiLCJrZXlDb2RlTWFwIiwid2hpY2giLCJ0eXBlIiwicGxheWVyT2JqZWN0IiwidGV4dHVyZSIsIlRleHR1cmVMb2FkZXIiLCJsb2FkIiwiQm94R2VvbWV0cnkiLCJtYXRlcmlhbCIsIm1hcCIsInBhcmFtZXRlcnMiLCJoZWlnaHQiLCJ6IiwibWFrZVBsYXllck9iamVjdCIsImNvbnRyb2xzIiwibW92ZW1lbnQiLCJhcnJvd3MiLCJ1cCIsImRvd24iLCJsZWZ0IiwicmlnaHQiLCJ3YXNkIiwicmVzZXQiLCJlbmFibGVkQ29udHJvbHMiLCJzcGVlZCIsInJvdGF0aW9uU3BlZWQiLCJhZGRFdmVudExpc3RlbmVyIiwidHJhbnNsYXRlWiIsInJvdGF0ZVkiLCJzZXQiXSwibWFwcGluZ3MiOiJhQUlBLElBQU1BLGdCQUFrQixFQUNsQkMsY0FBZ0JDLE9BQU9DLFlBQ3ZCQyxhQUFlRixPQUFPRyxXQUN0QkMsYUFDRixTQUNBLFNBQ0EsU0FDQSxNQUNBLE1BQ0EsSUFDQSxVQUVFQyxjQUFnQkQsWUFBWUUsT0FDNUJDLGFBQWUsSUFDZkMsWUFBYyxJQUNkQyxXQUFhLEdBQ2JDLFdBQWEsR0FDYkMsV0FBYSxHQ2pCYkMsYUFBZ0IsV0FTbEIsU0FBU0MsSUFRTCxJQUFLLElBUENDLEVBQVcsSUFBSUMsTUFBTUMsY0FDdkJSLFlBQ0FELGFBQ0FULGdCQUNBLEdBRUFtQixLQUNLQyxFQUFJLEVBQUdBLEVBQUlkLFlBQVlFLE9BQVFZLElBQ3BDRCxFQUFVRSxLQUNOLElBQUlKLE1BQU1LLG1CQUNOQyxNQUFPakIsWUFBWWMsR0FDbkJJLEtBQU1QLE1BQU1RLGNBS3hCLElBQUssSUFEQ0MsRUFBaUJWLEVBQVNXLE1BQU1uQixPQUFTLEVBQ3RDWSxFQUFJLEVBQUdBLEVBQUlNLEVBQWdCTixJQUFLLENBQ3JDLElBQUlRLEVBQVEsRUFBSlIsRUFDUkosRUFBU1csTUFBTUMsR0FBR0MsZUFDYlQsRUFBSVUsS0FBS0MsTUFBTVgsRUFBSXBCLGtCQUFvQk8sY0FDNUNTLEVBQVNXLE1BQU1DLEVBQUksR0FBR0MsZUFDakJULEVBQUlVLEtBQUtDLE1BQU1YLEVBQUlwQixrQkFBb0JPLGNBR2hELElB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Y2VzQ29udGVudCI6WyIvKipcbiAqIEFsbCBjb25zdGFudHMsIGF2YWlsYWJsZSBpbiBnbG9iYWwgd2luZG93LlxuICovXG5cbmNvbnN0IFdPUkxEX1NJREVfU0laRSA9IDc7XG5jb25zdCBXSU5ET1dfSEVJR0hUID0gd2luZG93LmlubmVySGVpZ2h0O1xuY29uc3QgV0lORE9XX1dJRFRIID0gd2luZG93LmlubmVyV2lkdGg7XG5jb25zdCBST0FEX0NPTE9SUyA9IFtcbiAgICAweGZmMDAwMCxcbiAgICAweGZmODgwMCxcbiAgICAweGZmZmYwMCxcbiAgICAweDAwZmYwMCxcbiAgICAweDAwZmZmZixcbiAgICAweDAwMDBmZixcbiAgICAweGZmMDBmZlxuXTtcbmNvbnN0IE5VTUJFUl9DT0xPUlMgPSBST0FEX0NPTE9SUy5sZW5ndGg7XG5jb25zdCBXT1JMRF9IRUlHSFQgPSAxMDAwO1xuY29uc3QgV09STERfV0lEVEggPSAxMDA7XG5jb25zdCBDQVJfU0laRV9YID0gMTA7XG5jb25zdCBDQVJfU0laRV9ZID0gMTA7XG5jb25zdCBDQVJfU0laRV9aID0gMTA7XG4iLCIvKipcbiAqIE1haW4gZmlsZSBvZiB0aGUgZ2FtZS5cbiAqL1xuXG5jb25zdCBOb3RNYXJpb0thcnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG4gICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcigpO1xuICAgIGNvbnN0IG1pbmlNYXBDYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoNzUsIDEsIDAuMSwgMTAwMCk7XG5cbiAgICBmdW5jdGlvbiBhZGRUb1NjZW5lKG9iamVjdCkge1xuICAgICAgICBzY2VuZS5hZGQob2JqZWN0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBidWlsZEZsb29yKCkge1xuICAgICAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KFxuICAgICAgICAgICAgV09STERfV0lEVEgsXG4gICAgICAgICAgICBXT1JMRF9IRUlHSFQsXG4gICAgICAgICAgICBXT1JMRF9TSURFX1NJWkUsXG4gICAgICAgICAgICAxXG4gICAgICAgICk7XG4gICAgICAgIGxldCBtYXRlcmlhbHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBST0FEX0NPTE9SUy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWF0ZXJpYWxzLnB1c2goXG4gICAgICAgICAgICAgICAgbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IFJPQURfQ09MT1JTW2ldLFxuICAgICAgICAgICAgICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZ2VvRmFjZXNMZW5ndGggPSBnZW9tZXRyeS5mYWNlcy5sZW5ndGggLyAyOyAvLyA8LS0gUmlnaHQgaGVyZS4gVGhpcyBzaG91bGQgc3RpbGwgYmUgOHg4ICg2NClcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnZW9GYWNlc0xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgaiA9IGkgKiAyOyAvLyA8LS0gQWRkZWQgdGhpcyBiYWNrIHNvIHdlIGNhbiBkbyBldmVyeSBvdGhlciAnZmFjZSdcbiAgICAgICAgICAgIGdlb21ldHJ5LmZhY2VzW2pdLm1hdGVyaWFsSW5kZXggPVxuICAgICAgICAgICAgICAgIChpICsgTWF0aC5mbG9vcihpIC8gV09STERfU0lERV9TSVpFKSkgJSBOVU1CRVJfQ09MT1JTOyAvLyBUaGUgY29kZSBoZXJlIGlzIGNoYW5nZWQsIHJlcGxhY2luZyBhbGwgJ2kncyB3aXRoICdqJ3MuIEtFRVAgVEhFIDhcbiAgICAgICAgICAgIGdlb21ldHJ5LmZhY2VzW2ogKyAxXS5tYXRlcmlhbEluZGV4ID1cbiAgICAgICAgICAgICAgICAoaSArIE1hdGguZmxvb3IoaSAvIFdPUkxEX1NJREVfU0laRSkpICUgTlVNQkVSX0NPTE9SUzsgLy8gQWRkIHRoaXMgbGluZSBpbiwgdGhlIG1hdGVyaWFsIGluZGV4IHNob3VsZCBzdGF5IHRoZSBzYW1lLCB3ZSdyZSBqdXN0IGRvaW5nIHRoZSBvdGhlciBoYWxmIG9mIHRoZSBzYW1lIGZhY2VcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBmbG9vciA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbHMpO1xuICAgICAgICBmbG9vci5yb3RhdGVYKC1NYXRoLlBJIC8gMik7XG4gICAgICAgIGZsb29yLnBvc2l0aW9uLnkgPSAwO1xuXG4gICAgICAgIHNjZW5lLmFkZChmbG9vcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgcmVuZGVyZXIuc2V0U2l6ZShXSU5ET1dfV0lEVEgsIFdJTkRPV19IRUlHSFQpO1xuICAgICAgICByZW5kZXJlci5zZXRQaXhlbFJhdGlvKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTtcbiAgICAgICAgcmVuZGVyZXIuZG9tRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocmVuZGVyZXIuZG9tRWxlbWVudCk7XG4gICAgICAgIHJlbmRlcmVyLmF1dG9DbGVhciA9IGZhbHNlO1xuXG4gICAgICAgIG1pbmlNYXBDYW1lcmEucG9zaXRpb24ueSA9IDUwMDtcbiAgICAgICAgbWluaU1hcENhbWVyYS5yb3RhdGlvbi54ID0gLTkwICogTWF0aC5QSSAvIDE4MDtcblxuICAgICAgICBidWlsZEZsb29yKCk7XG5cbiAgICAgICAgbG9vcCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvb3AoKSB7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcblxuICAgICAgICByZW5kZXJlci5jbGVhcigpO1xuXG4gICAgICAgIHJlbmRlcmVyLnNldFZpZXdwb3J0KDAsIDAsIFdJTkRPV19XSURUSCwgV0lORE9XX0hFSUdIVCk7XG4gICAgICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgUGxheWVyLmNhbWVyYSk7XG5cbiAgICAgICAgcmVuZGVyZXIuc2V0Vmlld3BvcnQoV0lORE9XX1dJRFRIIC0gMjAwLCA1MCwgMTUwLCAxNTApO1xuICAgICAgICByZW5kZXJlci5yZW5kZXIoc2NlbmUsIG1pbmlNYXBDYW1lcmEpO1xuXG4gICAgICAgIFBsYXllci5kb01vdmVtZW50TG9vcCgpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQ6IGluaXQsXG4gICAgICAgIGFkZFRvU2NlbmU6IGFkZFRvU2NlbmVcbiAgICB9O1xufSkoKTtcbiIsIi8qKlxuICogRXZlcnl0aGluZyBhYm91dCB0aGUgUGxheWVyIG9iamVjdCwgaXRzIGNhbWVyYSwgdGhlIG1vdmVtZW50cyAuLi5cbiAqL1xuXG5jb25zdCBQbGF5ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYShcbiAgICAgICAgNzUsXG4gICAgICAgIFdJTkRPV19XSURUSCAvIFdJTkRPV19IRUlHSFQsXG4gICAgICAgIDAuMSxcbiAgICAgICAgMTAwMFxuICAgICk7XG5cbiAgICBjb25zdCBwbGF5ZXJPYmplY3QgPSBtYWtlUGxheWVyT2JqZWN0KCk7XG5cbiAgICBjb25zdCBjb250cm9scyA9IHtcbiAgICAgICAgbW92ZW1lbnQ6IHtcbiAgICAgICAgICAgIC8vIFRPRE86IHRoZXNlIHNob3VsZCBiZSBpbiBhIHNldHRpbmdzIG1lbnUgb25jZSB3ZSBoYXZlIG9uZS5cbiAgICAgICAgICAgIGFycm93czoge1xuICAgICAgICAgICAgICAgIHVwOiAzOCxcbiAgICAgICAgICAgICAgICBkb3duOiA0MCxcbiAgICAgICAgICAgICAgICBsZWZ0OiAzNyxcbiAgICAgICAgICAgICAgICByaWdodDogMzlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB3YXNkOiB7XG4gICAgICAgICAgICAgICAgdXA6IDg3LFxuICAgICAgICAgICAgICAgIGRvd246IDgzLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDY1LFxuICAgICAgICAgICAgICAgIHJpZ2h0OiA2OFxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNldDogOFxuICAgIH07XG5cbiAgICBsZXQgZW5hYmxlZENvbnRyb2xzID0gY29udHJvbHMubW92ZW1lbnQuYXJyb3dzO1xuXG4gICAgY29uc3Qgc3BlZWQgPSAwLjU7XG4gICAgY29uc3Qgcm90YXRpb25TcGVlZCA9IDAuMDM7XG5cbiAgICBjb25zdCBrZXlDb2RlTWFwID0ge307XG5cbiAgICBmdW5jdGlvbiBvbktleU1vdmUoZSkge1xuICAgICAgICBlID0gZSB8fCBldmVudDsgLy8gRm9yIElFLlxuICAgICAgICBrZXlDb2RlTWFwW2Uud2hpY2hdID0gZS50eXBlID09PSAna2V5ZG93bic7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uS2V5TW92ZSwgZmFsc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgb25LZXlNb3ZlLCBmYWxzZSk7XG5cbiAgICBmdW5jdGlvbiBkb01vdmVtZW50TG9vcCgpIHtcbiAgICAgICAgaWYgKGtleUNvZGVNYXBbZW5hYmxlZENvbnRyb2xzLnVwXSkge1xuICAgICAgICAgICAgcGxheWVyT2JqZWN0LnRyYW5zbGF0ZVooLXNwZWVkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoa2V5Q29kZU1hcFtlbmFibGVkQ29udHJvbHMubGVmdF0pIHtcbiAgICAgICAgICAgIHBsYXllck9iamVjdC5yb3RhdGVZKHJvdGF0aW9uU3BlZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChrZXlDb2RlTWFwW2VuYWJsZWRDb250cm9scy5yaWdodF0pIHtcbiAgICAgICAgICAgIHBsYXllck9iamVjdC5yb3RhdGVZKC1yb3RhdGlvblNwZWVkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoa2V5Q29kZU1hcFtlbmFibGVkQ29udHJvbHMuZG93bl0pIHtcbiAgICAgICAgICAgIHBsYXllck9iamVjdC50cmFuc2xhdGVaKHNwZWVkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoa2V5Q29kZU1hcFtjb250cm9scy5yZXNldF0pIHtcbiAgICAgICAgICAgIHBsYXllck9iamVjdC5yb3RhdGlvbi55ID0gMDtcbiAgICAgICAgICAgIHBsYXllck9iamVjdC5wb3NpdGlvbi5zZXQoMCwgcGxheWVyT2JqZWN0LnBvc2l0aW9uLnksIDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFrZVBsYXllck9iamVjdCgpIHtcbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZCgnL2Fzc2V0cy9vYmplY3QtdGV4dHVyZXMvcGxheWVyLmpwZycpO1xuICAgICAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeShcbiAgICAgICAgICAgIENBUl9TSVpFX1gsXG4gICAgICAgICAgICBDQVJfU0laRV9ZLFxuICAgICAgICAgICAgQ0FSX1NJWkVfWlxuICAgICAgICApO1xuICAgICAgICBjb25zdCBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7IG1hcDogdGV4dHVyZSB9KTtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcblxuICAgICAgICBvYmplY3QucG9zaXRpb24ueSA9IG9iamVjdC5nZW9tZXRyeS5wYXJhbWV0ZXJzLmhlaWdodCAvIDI7XG5cbiAgICAgICAgY2FtZXJhLnBvc2l0aW9uLnggPSAxO1xuICAgICAgICBjYW1lcmEucG9zaXRpb24ueSA9IDEwO1xuICAgICAgICBjYW1lcmEucG9zaXRpb24ueiA9IDE1O1xuXG4gICAgICAgIG9iamVjdC5hZGQoY2FtZXJhKTtcbiAgICAgICAgTm90TWFyaW9LYXJ0LmFkZFRvU2NlbmUob2JqZWN0KTtcblxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGRvTW92ZW1lbnRMb29wOiBkb01vdmVtZW50TG9vcCxcbiAgICAgICAgcGxheWVyT2JqZWN0OiBwbGF5ZXJPYmplY3QsXG4gICAgICAgIGNhbWVyYTogY2FtZXJhXG4gICAgfTtcbn0pKCk7XG4iXX0=
